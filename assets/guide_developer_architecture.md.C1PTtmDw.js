import{_ as e,c as a,o as i,ag as t}from"./chunks/framework._dqZt2de.js";const g=JSON.parse('{"title":"System Architecture","description":"","frontmatter":{},"headers":[],"relativePath":"guide/developer/architecture.md","filePath":"guide/developer/architecture.md"}'),n={name:"guide/developer/architecture.md"};function r(l,s,o,p,c,h){return i(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="system-architecture" tabindex="-1">System Architecture <a class="header-anchor" href="#system-architecture" aria-label="Permalink to &quot;System Architecture&quot;">​</a></h1><blockquote><p>&quot;Simple enough to maintain, powerful enough to scale.&quot;</p></blockquote><h2 id="_1-high-level-diagram" tabindex="-1">1. High-Level Diagram <a class="header-anchor" href="#_1-high-level-diagram" aria-label="Permalink to &quot;1. High-Level Diagram&quot;">​</a></h2><div class="language-mermaid vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph TD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    User[User (PWA)] --&gt;|HTTPS| CDN[Vercel Edge Network]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    CDN --&gt;|Next.js App Router| Web[apps/web]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    subgraph &quot;Data Layer (Supabase)&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        DB[(PostgreSQL)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Auth[GoTrue Auth]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Realtime[Realtime Engine]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    subgraph &quot;Background Processing&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Worker[apps/worker]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Redis[(Upstash Redis)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Scripts[scripts/*.ts]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Web --&gt;|Prisma ORM| DB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Web --&gt;|Supabase SDK| Auth</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Worker --&gt;|BullMQ| Redis</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Worker --&gt;|Prisma ORM| DB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Scripts --&gt;|Direct DB Access| DB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Scripts --&gt;|AI Processing| Hermes[Hermes AI]</span></span></code></pre></div><h2 id="_2-core-components" tabindex="-1">2. Core Components <a class="header-anchor" href="#_2-core-components" aria-label="Permalink to &quot;2. Core Components&quot;">​</a></h2><h3 id="frontend-apps-web" tabindex="-1">Frontend (<code>apps/web</code>) <a class="header-anchor" href="#frontend-apps-web" aria-label="Permalink to &quot;Frontend (\`apps/web\`)&quot;">​</a></h3><ul><li><strong>Framework</strong>: Next.js 16 (App Router)</li><li><strong>Rendering</strong>: Hybrid (Static Export for marketing, Server Components for data, Client Components for interactivity).</li><li><strong>State</strong>: React Query (Server State) + Zustand (Client State).</li><li><strong>Styling</strong>: Tailwind CSS + Framer Motion.</li></ul><h3 id="background-worker-apps-worker" tabindex="-1">Background Worker (<code>apps/worker</code>) <a class="header-anchor" href="#background-worker-apps-worker" aria-label="Permalink to &quot;Background Worker (\`apps/worker\`)&quot;">​</a></h3><ul><li><strong>Engine</strong>: Node.js + BullMQ.</li><li><strong>Role</strong>: Handles heavy lifting off the main thread. <ul><li><em>Daily Import</em>: Syncs KML/CSV data.</li><li><em>Analytics Aggregation</em>: Pre-calculates stats for the Pulse Dashboard.</li><li><em>Notifications</em>: Delivers push alerts.</li></ul></li></ul><h3 id="the-script-brain-scripts" tabindex="-1">The &quot;Script Brain&quot; (<code>scripts/</code>) <a class="header-anchor" href="#the-script-brain-scripts" aria-label="Permalink to &quot;The &quot;Script Brain&quot; (\`scripts/\`)&quot;">​</a></h3><ul><li><strong>Role</strong>: The operational intelligence of HelpmApp.</li><li><strong>Key Pipelines</strong>: <ul><li><code>universal-enrichment.ts</code>: The &quot;ETL&quot; pipeline (Extract, Transform, Load) for new services.</li><li><code>standardize-data.ts</code>: AI standardization engine.</li></ul></li></ul><h2 id="_3-data-flow" tabindex="-1">3. Data Flow <a class="header-anchor" href="#_3-data-flow" aria-label="Permalink to &quot;3. Data Flow&quot;">​</a></h2><ol><li><strong>Ingestion</strong>: <ul><li>Raw data (Charity Commission, KML) -&gt; <code>scripts/ingest-*.ts</code> -&gt; <code>ServiceDraft</code> table.</li></ul></li><li><strong>Enrichment</strong>: <ul><li><code>ServiceDraft</code> -&gt; <code>universal-enrichment.ts</code> (Geocode, Scrape, AI) -&gt; <code>Service</code> table (Active).</li></ul></li><li><strong>Consumption</strong>: <ul><li>User -&gt; Search Query -&gt; PostgreSQL Full Text Search -&gt; JSON Response.</li></ul></li></ol><h2 id="_4-key-design-decisions" tabindex="-1">4. Key Design Decisions <a class="header-anchor" href="#_4-key-design-decisions" aria-label="Permalink to &quot;4. Key Design Decisions&quot;">​</a></h2><ul><li><strong>Monorepo</strong>: Shared types (<code>packages/types</code>) ensure database schema matches frontend interfaces.</li><li><strong>Zero-API Middleman</strong>: We use Server Actions and Prisma directly in Next.js, avoiding a separate REST API server for the frontend.</li><li><strong>Row Level Security (RLS)</strong>: While we use Prisma for admin tasks, user-facing data is protected by Supabase RLS policies where applicable.</li></ul>`,15)])])}const k=e(n,[["render",r]]);export{g as __pageData,k as default};
